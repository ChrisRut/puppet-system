{"tagline":"Manage Linux system resources and services from hiera configuration","note":"Don't delete this file! It's used internally to help with page regeneration.","google":"","body":"# puppet-system\r\n\r\nManage Linux system resources and services from hiera configuration.\r\n\r\n* *crontabs*: set user crontab entries\r\n* *execs*:  run idempotent external commands\r\n* *facts*: set custom facts\r\n* *files*: create/update files or directories\r\n* *groups*: manage entries in /etc/group\r\n* *hosts*: manage entries in /etc/hosts\r\n* *limits*: manage entries in /etc/security/limits.conf\r\n* *mailaliases* manage entries in /etc/aliases\r\n* *mounts*: manage entries in /etc/fstab\r\n* *packages*: manage system packages\r\n* *services*: manage system services\r\n* *sshd*: manage configuration in /etc/ssh/sshd_config including subsystems like sftp\r\n* *sysconfig*: manage files under /etc/sysconfig: clock, i18n, keyboard, puppet-dashboard, puppet, puppetmaster, selinux\r\n* *sysctl*: manage entries in /etc/sysctl.conf\r\n* *users*: manage users in /etc/passwd and /etc/shadow\r\n* *yumgroups*: manage system package groups\r\n* *yumrepos*: manage yum repository files under /etc/yum.repos.d\r\n\r\n## Documentation\r\n\r\nFor default types (users, groups, mounts, yumrepos, packages, cron, exec) see\r\nthe documentation at http://docs.puppetlabs.com/references/latest/type.html for\r\nthe parameters that can be passed to each of the resources.\r\n\r\nFor augeasproviders types (sysctl, sshd) see\r\nhttp://forge.puppetlabs.com/domcleal/augeasproviders.\r\n\r\nFor limits see http://forge.puppetlabs.com/erwbgy/limits.\r\n\r\n## Usage\r\n\r\nInclude the system module in your puppet configuration:\r\n\r\n    include system\r\n\r\nand add required hiera configuration.\r\n\r\n## crontabs\r\n\r\nSet user crontab entries\r\n\r\nExample configuration:\r\n\r\n    system::crontabs:\r\n      'root-logrotate':\r\n        command: '/usr/sbin/logrotate'\r\n        user:    'root'\r\n        hour:    '2'\r\n        minute:  '0'\r\n\r\nDefaults:\r\n\r\n* ensure: present\r\n* user: root\r\n\r\n## execs\r\n\r\nRun idempotent external commands\r\n\r\nExample configuration:\r\n\r\n    system::execs:\r\n      'update-tomcat-deploy':\r\n        command: '/usr/bin/svn up'\r\n        cwd:     '/apps/tomcat1/deploy'\r\n        user:    'tomcat1'\r\n      'create-deploy-dir':\r\n        command: '/bin/mkdir -p /apps/tomcat1/deploy'\r\n        unless:  '/usr/bin/test -d /apps/tomcat1/deploy'\r\n\r\nNote: The commands will be run on every Puppet run unless you specify 'onlyif',\r\n'unless' or 'refreshonly' parameters.\r\n\r\n## facts\r\n\r\nSet custom facts\r\n\r\nExample configuration:\r\n\r\n    system::facts:\r\n      location:\r\n        value: 'London'\r\n\r\n## files\r\n\r\nCreate or update files or directories\r\n\r\nExample 1 - create a mount point for an NFS mounted directory:\r\n\r\n    system::files:\r\n      /apps:\r\n        ensure:  'directory'\r\n        owner:   'root'\r\n        group:   'root'\r\n        mode:    '0755'\r\n\r\nExample 2 - create a file with the given content:\r\n\r\n    system::files:\r\n      /etc/motd:\r\n        ensure:  'present'\r\n        owner:   'root'\r\n        group:   'root'\r\n        mode:    '0644'\r\n        content: \"Authorised access only\\nIf unauthorised log off now or face prosecution\\n\"\r\n\r\nNote: Use double-quotes with content if it contains embedded newlines (\\n) or\r\ntabs (\\t).  Normaly you will also want a terminating newline.\r\n\r\n## groups\r\n\r\nManage entries in /etc/group\r\n\r\nExample configuration:\r\n\r\n    system::groups:\r\n      'keith':\r\n        ensure: 'present'\r\n        gid:    '500'\r\n      'fred':\r\n        gid:    '503'\r\n \r\nDefaults:\r\n\r\n* ensure: present\r\n\r\n## hosts\r\n\r\nManage entries in /etc/hosts\r\n\r\nExample configuration:\r\n\r\n    system::hosts:\r\n      puppet:\r\n        ensure:       'present'\r\n        ip:           '10.5.11.19'\r\n        host_aliases: [ 'puppet.local' ]\r\n\r\nDefaults:\r\n* ensure: present\r\n\r\nSee: http://docs.puppetlabs.com/references/latest/type.html#host\r\n\r\n## limits\r\n\r\nManage entries in /etc/security/limits.conf\r\n\r\nExample configuration:\r\n\r\n    system::limits:\r\n      '*':\r\n        nofile:\r\n          soft: 1024\r\n          hard: 2048\r\n      '@weblogic':\r\n        nofile:\r\n          soft: 16384\r\n          hard: 16384\r\n        nproc:\r\n          soft: 2048\r\n          hard: 2048\r\n\r\nNo defaults.\r\n\r\n## mailaliases\r\n\r\nManage entries in /etc/aliases\r\n\r\nExample configuration:\r\n\r\n    system::mailaliases:\r\n      postmaster:\r\n        recipient: 'root'\r\n      webmaster:\r\n        recipient: 'fred@domain.com'\r\n\r\nNo defaults.\r\n\r\nSee: http://docs.puppetlabs.com/references/latest/type.html#mailalias\r\n\r\n## mounts\r\n\r\nManage entries in /etc/fstab\r\n\r\nExample configuration:\r\n\r\n    system::mounts:\r\n      '/home':\r\n        ensure:  'mounted'\r\n        device:  '/dev/mapper/vg_x120-lv_home'\r\n        atboot:  'true'\r\n        fstype:  'ext4'\r\n        options: 'defaults'\r\n\r\nDefaults:\r\n\r\n* atboot: true\r\n* ensure: mounted\r\n\r\nNote: These resources are created last so any required users, groups or mount\r\npoint directories have a chance to be created first.\r\n\r\n## packages\r\n\r\nManage system packages\r\n\r\nExample configuration:\r\n\r\n    system::packages:\r\n      AdobeReader_enu:\r\n        ensure: '9.5.1-1'\r\n      ConsoleKit:\r\n        ensure: '0.4.5-2.fc17'\r\n\r\nDefaults:\r\n\r\n* ensure: installed\r\n\r\n## services\r\n\r\nManage system services\r\n\r\nExample configuration:\r\n\r\n    system::services:\r\n      cups:\r\n        ensure: 'stopped'\r\n        enable: 'false'\r\n      sshd:\r\n        ensure: 'running'\r\n        enable: 'true'\r\n      ntpd:\r\n        ensure: 'running'\r\n        enable: 'true'\r\n\r\nDefaults:\r\n\r\n* ensure: running\r\n\r\nNote:\r\n\r\n* Do not specify any services that are managed by other Puppet modules (eg.\r\n  ntpd or network) otherwise you may get conflicts\r\n\r\n## sshd\r\n\r\nManage settings in /etc/ssh/sshd.conf\r\n\r\nSynchronize host keys file entries across all puppet-managed hosts.\r\n\r\nExample configuration:\r\n\r\n    system::sshd:\r\n      AllowGroups:\r\n        value:     [ 'sshusers', 'admin' ]\r\n      PermitRootLogin:\r\n        value:     'without-password'\r\n        condition: 'Host example.net'\r\n\r\n    system::sshd::subsystem:\r\n      sftp:\r\n        command: '/usr/libexec/openssh/sftp-server -u 0002'\r\n\r\n    system::sshd::sync_host_keys: 'true'\r\n\r\nNo defaults.\r\n\r\nSee:\r\n\r\n* https://github.com/domcleal/augeasproviders/blob/master/lib/puppet/type/sshd_config.rb\r\n* https://github.com/domcleal/augeasproviders/blob/master/lib/puppet/type/sshd_config_subsystem.rb\r\n\r\n## sysconfig\r\n\r\nManage settings in files under /etc/sysconfig\r\n\r\nExample configuration:\r\n\r\n    system::sysconfig::clock:\r\n      timezone: 'Europe/London'\r\n\r\n    system::sysconfig::i18n:\r\n      # Run 'locale -a' to see possible lang values\r\n      lang: 'en_GB.utf8'\r\n\r\n    system::sysconfig::keyboard:\r\n      keytable:     'uk'\r\n      model:        'pc105'\r\n      layout:       'gb'\r\n      keyboardtype: 'pc'\r\n\r\n    system::sysconfig::puppet:\r\n      server: 'puppet.sbet'\r\n\r\n    system::sysconfig::selinux:\r\n      state: 'enforcing'\r\n\r\nNo defaults.\r\n\r\n## sysctl\r\n\r\nManage settings in /etc/sysctl.conf\r\n\r\nExample configuration:\r\n\r\n    system::sysctl:\r\n      kernel.msgmnb:\r\n        value: '131072'\r\n        comment: 'Controls the default maximum size of a message queue'\r\n      kernel.msgmax:\r\n        value: '131072'\r\n        comment: ' Controls the maximum size of a message, in bytes'\r\n\r\nNo defaults.\r\n\r\nSee:\r\n\r\n* https://github.com/domcleal/augeasproviders/blob/master/lib/puppet/type/sysctl.rb\r\n\r\n\r\nNote: Quote numeric values to avoid \"can't convert Fixnum into String\" errors\r\n\r\n## users\r\n\r\nManage users entries in /etc/passwd and /etc/shadow\r\n\r\nExample configuration:\r\n\r\n    system::users:\r\n      'keith':\r\n        ensure:    'present'\r\n        comment:   'Keith Burdis'\r\n        gid:       '500'\r\n        groups:    ['wheel']\r\n        home:      '/home/keith'\r\n        shell:     '/bin/bash'\r\n        uid:       '500'\r\n      'fred':\r\n        comment:   'Fred Bloggs'\r\n        uid:       '503'\r\n        gid:       '503'\r\n        home:      '/home/fred'\r\n        managehome: true\r\n\r\nDefaults:\r\n\r\n* ensure: present\r\n* shell:  /bin/bash\r\n\r\n## yumgroups\r\n\r\nManage system package groups\r\n\r\nExample configuration:\r\n\r\n    system::yumgroups:\r\n      'Base':\r\n        ensure: 'present'\r\n      'Console internet tools':\r\n        ensure: 'present'\r\n      'Perl Support':\r\n        ensure: 'present'\r\n        usecache: false\r\n      'Ruby Support':\r\n        ensure: 'present'\r\n        optional: true\r\n        usecache: false\r\n\r\nDefaults:\r\n\r\n* optional: false\r\n* usecache: true\r\n\r\nNote: Set 'usecache: false' if 'yum -C grouplist' does not work on your system\r\nand you are getting System::Yumgroup resources created on every Puppet run\r\n\r\n## yumrepos\r\n\r\nManage yum repository files under /etc/yum.repos.d\r\n\r\nExample configuration:\r\n\r\n    system::yumrepos:\r\n      'puppetlabs-deps':\r\n        baseurl:  'http://yum.puppetlabs.com/fedora/f17/dependencies/$basearch'\r\n        descr:    'Puppet Labs Dependencies Fedora 17 - $basearch'\r\n        enabled:  '1'\r\n        gpgcheck: '1'\r\n        gpgkey:   'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs'\r\n      'puppetlabs-products':\r\n        baseurl:  'http://yum.puppetlabs.com/fedora/f17/products/$basearch'\r\n        descr:    'Puppet Labs Products Fedora 17 - $basearch'\r\n        enabled:  '1'\r\n        gpgcheck: '1'\r\n        gpgkey:   'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs'\r\n\r\nDefaults:\r\n\r\n* enabled: 1\r\n* gpgcheck: 1\r\n\r\n## providers\r\n\r\nThe augeasproviders module can be an alternate provider for the host, mailalias\r\nand mounttab types.\r\n\r\nExample configuration:\r\n\r\n    system::providers:\r\n      host: 'augeas'\r\n      mailalias: 'augeas'\r\n      mounttab: 'augeas'\r\n\r\n## Notes\r\n\r\n* When requiring packages in other modules wrap them in an \"if !defined\" check\r\n  to avoid conflicts with system::packages - for example:\r\n\r\n    if ! defined(Package['bash']) { package { 'bash': ensure => installed } }\r\n\r\n* Put the system class *first* in the list of classes to include when using\r\n  hiera_include. This avoids problems with conflicting package declarations -\r\n  which shouldn't be a problem because system::packages is run in an earlier \r\n  run stage but is.\r\n\r\n* As with many default types you can often specify a 'target' parameter to\r\n  specify a different configuration filename to change.\r\n\r\n## Support\r\n\r\nLicense: Apache License, Version 2.0\r\n\r\nGitHub URL: https://github.com/erwbgy/puppet-system\r\n","name":"Puppet-system"}